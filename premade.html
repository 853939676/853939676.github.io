<html>

<head>
    <title>Premade</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>

<body>
    <h1>Premade Visualizations</h1>
    <p>Map of traffic crashes in Champaign County</p>
    <div id="map_vis"></div>
    <p>Count of records, mean of injuries and fatalities by year</p>
    <div id="fact_vis"></div>


</body>
<script>
    var map_vis_spec =
    {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "width": 400,
        "height": 500,
        "layer": [
            {
                "data": {
                    "url": "https://gist.githubusercontent.com/jefffriesen/6892860/raw/e1f82336dde8de0539a7bac7b8bc60a23d0ad788/zips_us_topo.json",
                    "format": {
                        "type": "topojson",
                        "feature": "zip_codes_for_the_usa"
                    }
                },
                "transform": [
                    {
                        "filter": {
                            "field": "properties.zip",
                            "oneOf": ["60598", "60949", "60957", "61801", "61802", "61803", "61810", "61815", "61816", "61820", "61821", "61822",
                                "61824", "61825", "61826", "61840", "61843", "61845", "61847", "61849", "61851", "61852", "61853", "61859", "61862",
                                "61863", "61864", "61866", "61871", "61872", "61873", "61874", "61875", "61877", "61878", "61880", "61884", "61956"]
                        }
                    }
                ],
                "projection": {
                    "type": "albersUsa"
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "#e9ebf0",
                    "stroke": "white"
                },
                "encoding": {
                    tooltip: [
                        { field: "properties.name", title: "City" },
                        { field: "properties.zip", title: "Zip" }
                    ]

                }
            },
            {
                "data": {
                    "url": "https://raw.githubusercontent.com/853939676/IS545/main/final_crashes.csv"
                },
                "projection": {
                    "type": "albersUsa"
                },
                "mark": "circle",
                "encoding": {
                    "longitude": {
                        "field": "x",
                        "type": "quantitative"
                    },
                    "latitude": {
                        "field": "y",
                        "type": "quantitative"
                    },
                    "size": { "value": 10 },
                    "color": { "value": "steelblue" },
                    "tooltip": [
                        { "field": "year", "type": "quantitative" },
                        { "field": "city", "type": "nominal" },
                        { "field": "crash_severity", "type": "nominal" },
                        { "field": "collision_type", "type": "nominal" },
                        { "field": "fatality", "type": "quantitative" },
                        { "field": "injury", "type": "quantitative" },
                        { "field": "weather", "type": "nominal" },
                        { "field": "light", "type": "nominal" },
                        { "field": "road_surface", "type": "nominal" },
                        { "field": "traffic_control", "type": "nominal" }
                    ]
                }
            }
        ]
    };
    var embedded = vegaEmbed('#map_vis', map_vis_spec);

    var fact_spec =
    {
        "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
        "data": { "url": "https://raw.githubusercontent.com/853939676/IS545/main/final_crashes.csv" },
        "vconcat": [
            {
                "mark": { "type": "bar" },
                "encoding": {
                    "x": { "field": "year", "type": "ordinal" },
                    "y": { "aggregate": "count", "type": "quantitative" },
                    "color": {
                        "field": "city",
                        "type": "nominal"
                    },
                    "tooltip": [
                        { "type": "nominal", "field": "year" },
                        { "type": "quantitative", "aggregate": "count" },
                        { "type": "nominal", "field": "city" }
                    ]
                }
            },
            {
                "mark": "circle",
                "encoding": {
                    "y": { "field": "injury", "type": "quantitative", "aggregate": "mean" },
                    "x": { "field": "year", "type": "ordinal" },
                    "size": {
                        "field": "injury",
                        "type": "quantitative",
                        "aggregate": "max"
                    },
                    "color": {
                        "field": "injury",
                        "type": "quantitative",
                        "aggregate": "max",
                        "scale": { "range": ["#c6dbef", "#1f77b4"] }
                    },
                    "tooltip": [
                        { "type": "nominal", "field": "year" },
                        { "type": "quantitative", "field": "injury", "aggregate": "mean" },
                        { "type": "quantitative", "field": "injury", "aggregate": "max" }
                    ]
                }
            },
            {
                "mark": "circle",
                "encoding": {
                    "y": { "field": "fatality", "type": "quantitative", "aggregate": "mean" },
                    "x": { "field": "year", "type": "ordinal" },
                    "size": {
                        "field": "fatality",
                        "type": "quantitative",
                        "aggregate": "max"
                    },
                    "color": {
                        "field": "fatality",
                        "type": "quantitative",
                        "aggregate": "max",
                        "scale": { "range": ["#c6dbef", "#1f77b4"] }
                    },
                    "tooltip": [
                        { "type": "nominal", "field": "year" },
                        { "type": "quantitative", "field": "fatality", "aggregate": "mean" },
                        { "type": "quantitative", "field": "fatality", "aggregate": "max" }
                    ]
                }
            }

        ]
    };
    var embedded = vegaEmbed('#fact_vis', fact_spec);
    ;

    var map_inter_spec =
    {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "width": 400,
        "height": 500,
        "data": {
            "url": "https://raw.githubusercontent.com/853939676/IS545/main/final_crashes.csv"
        },
        "projection": {
            "type": "albersUsa"
        },
        "mark": "circle",
        "encoding": {
            "longitude": {
                "field": "x",
                "type": "quantitative"
            },
            "latitude": {
                "field": "y",
                "type": "quantitative"
            },
            "size": { "value": 10 },
            "color": { "value": "steelblue" },
            "tooltip": [
                { "field": "year", "type": "quantitative" },
                { "field": "city", "type": "nominal" },
                { "field": "crash_severity", "type": "nominal" },
                { "field": "collision_type", "type": "nominal" },
                { "field": "fatality", "type": "quantitative" },
                { "field": "injury", "type": "quantitative" },
                { "field": "weather", "type": "nominal" },
                { "field": "light", "type": "nominal" },
                { "field": "road_surface", "type": "nominal" },
                { "field": "traffic_control", "type": "nominal" }
            ]
        }
    }
        ;
    var embedded = vegaEmbed('#map_inter_vis', map_inter_spec);

    var map_color_spec =
    {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "width": 400,
        "height": 500,
        "data": {
            "url": "https://raw.githubusercontent.com/853939676/IS545/main/final_crashes.csv"
        },
        "projection": {
            "type": "albersUsa"
        },
        "mark": "circle",
        "encoding": {
            "longitude": {
                "field": "x",
                "type": "quantitative"
            },
            "latitude": {
                "field": "y",
                "type": "quantitative"
            },
            "size": { "value": 10 },
            "color": {
                "field": "color",
                "type": "nominal"
            },
            "tooltip": [
                { "field": "year", "type": "quantitative" },
                { "field": "city", "type": "nominal" },
                { "field": "crash_severity", "type": "nominal" },
                { "field": "collision_type", "type": "nominal" },
                { "field": "fatality", "type": "quantitative" },
                { "field": "injury", "type": "quantitative" },
                { "field": "weather", "type": "nominal" },
                { "field": "light", "type": "nominal" },
                { "field": "road_surface", "type": "nominal" },
                { "field": "traffic_control", "type": "nominal" }
            ]
        }


    };
    var embedded = vegaEmbed('#map_col', map_color_spec);

</script>

</html>